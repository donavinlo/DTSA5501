---
title: "NYPD Dataset"
output:
  pdf_document: default
  pdf_notebook: default
---
```{r setup, include=FALSE}  
knitr::opts_chunk$set(echo = TRUE)
```

## Packages Needed
- Tidyverse
- Lubridate
```{r import_packages, message= FALSE}
library(tidyverse)
library(lubridate)
```


## Importing the data

First, I'll import the data from <https://catalog.data.gov/dataset>. This data
represents information about every shooting incident in New York City since
2006.
```{r data_import}
url_nypd <- paste0("https://data.cityofnewyork.us/api/views/833y-fsy8/",
              "rows.csv?accessType=DOWNLOAD")

nypd_shootings <- read_csv(url_nypd)

```


## Tidying Data

Looking at the column details, I can see some columns are not the correct 
variable types. Therefore, I will make the following changes

- *Incident_Key* is listed as a double type
  - I want to change this to a character string type since it is a unique label 
  for each incident.
- *Occur_Date* is listed as a string/character type
  - This needs to change to a date column using the **lubridate** package
- The following variables will need to be changed to a factor type because they
are categorical
  - *BORO*
  - *JURISDICTION_CODE*
  - *PERP_AGE_GROUP*
  - *PERP_SEX*
  - *PERP_RACE*
  - *VIC_AGE_GROUP*
  - *VIC_SEX*
  - *VIC_RACE*
- I'm also removing a few variableS that I don't feel have as much impact to the 
analysis. INCIDENT_KEY would be important if we were joinging multiple datasets.
In this case, we aren't; therefore, I am removing it along with the geographical
data.

```{r tidy_col_types}
nypd_shootings <- nypd_shootings %>% mutate(OCCUR_DATE = mdy(OCCUR_DATE)) %>%
  select(-c(INCIDENT_KEY, X_COORD_CD, Y_COORD_CD, Latitude, Longitude, Lon_Lat))

factor_cols <- c("BORO", "JURISDICTION_CODE", "PERP_AGE_GROUP", "PERP_SEX",
                 "PERP_RACE", "VIC_AGE_GROUP", "VIC_SEX", "VIC_RACE")
nypd_shootings[, factor_cols] <- nypd_shootings[, factor_cols] %>% 
  lapply(factor)
```

Viewing the summary, we can see that about of a third of the PERP_AGE_GROUP,
PERP_SEX, AND PER_RACE are missing. Also, PERP_SEX and PERP_RACE are heavily
skewed towards a specific factor. Therefore, I am dropping all three variables.
If we had access to more data,  I could probably fill the missing data using
various methods. Also, JURISDICTION_CODE only has two observations where the
data is missing, I will fill them with a random number between 0 and 2.

```{r data_summary}
summary(nypd_shootings)

```

```{r missing_vals}
nypd_shootings <- nypd_shootings %>%
  mutate(JURISDICTION_CODE = replace(JURISDICTION_CODE, is.na(JURISDICTION_CODE)
                                     , sample(0:2, 1))) %>%
  select(-c(PERP_AGE_GROUP, PERP_SEX, PERP_RACE))

summary(nypd_shootings)
```

## Visualization and Analysis

First, it would be a good idea to view the total amount of shootings between all
of the boroughs. We can see that there are a higher number of shootings between
Brooklyn and the Bronx compared to Manhattan, Queens and Staten Island. 
Bronx and Brooklyn are known for being the poorest boroughs in the area.
Could wealth be related to the number of incidents?
```{r borough_visual}
ggplot(nypd_shootings, aes(x=BORO)) + geom_bar()

```

Next, we can see that a majority of the victims of the shooting are between the
ages of 18-44. This is questions whether these incidents may be gang related. 
Are these incidents happening due low-income parents looking for resources?
Further investigation into the economy may help answere those questions. 
Looking back at the summary, why are most of these incidents involving harm to
african american males?

```{r age_visual}
ggplot(nypd_shootings, aes(x=VIC_AGE_GROUP)) +
  geom_bar()
```

## Data Modeling

  I would like to implement a binary logistic model to see whether a model can 
help predict if a shooting was a statistical murder or not. As we can see,
shootings with a jurisdiction of 2 has a negative, significant correlation on
if the shooting was a murder or not. However, we can see that when a victim
that is 65 years or older is a victim, there is almost no affect on whether it 
was a murder or not. Could the reason for this be because they are not seen as 
a threat compared to the younger generations? Also, according to the model,
Manhattan shootings are less likely to be considered a murder compared to the 
other boroughs. 

```{r model_data_create}
nypd_model_data <- nypd_shootings %>% 
select(-c("OCCUR_DATE", "OCCUR_TIME", "LOCATION_DESC"))

```

```{r model_data}
logit_1 <- glm(STATISTICAL_MURDER_FLAG ~., family = binomial, data=nypd_model_data)

summary(logit_1)
```


## Conclusion

  After reviewing the data, it seems as much of the shooting incidents occur
in the low income boroughs of New York City. We may need to stay aware that
these are shooting incidents that were investigated by New York. It's possible
that New York is more involved policing the lower income areas of the city. Some
incidents in Staten Island, Queens and Manhattan may not have been recorded.
Also, I may have exhibited some bias as to how I presented the data in this
case. I chose to review the income inequality and how it compares to age group.
As someone who was raised in a low-income household, this was a very interesting
point for me to review. Also, the model I developed had a lot of bias as well.
I didn't check for correlation between variables nor tune the model at all. This
can lead to significant issues within the model and possible statistical errors. 
As I learn more about the models, I can develop skills to reduce these biases! 
